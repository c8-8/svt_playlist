<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SEVENTEEN æ­Œæ›²ç³»çµ±æ¸¬è©¦é é¢</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        
        .test-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .test-header {
            color: #333;
            border-bottom: 2px solid #F7CAC9;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        
        .test-button {
            background: #F7CAC9;
            color: #333;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        
        .test-button:hover {
            background: #F5B7B1;
        }
        
        .test-result {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 15px;
            margin-top: 10px;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .success { color: #28a745; }
        .error { color: #dc3545; }
        .warning { color: #ffc107; }
        .info { color: #17a2b8; }
        
        .status {
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        
        .status.success { background: #d4edda; border: 1px solid #c3e6cb; }
        .status.error { background: #f8d7da; border: 1px solid #f5c6cb; }
        .status.warning { background: #fff3cd; border: 1px solid #ffeaa7; }
        .status.info { background: #d1ecf1; border: 1px solid #bee5eb; }
        
        .song-list {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #ddd;
            padding: 10px;
            background: white;
        }
        
        .song-item {
            padding: 8px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .song-title {
            font-weight: bold;
            color: #333;
        }
        
        .song-info {
            color: #666;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <h1>ğŸµ SEVENTEEN æ­Œæ›²ç³»çµ±æ¸¬è©¦é é¢</h1>
    
    <div class="test-container">
        <h2 class="test-header">ğŸ“Š ç³»çµ±ç‹€æ…‹æª¢æŸ¥</h2>
        <button class="test-button" onclick="checkSystemStatus()">æª¢æŸ¥ç³»çµ±ç‹€æ…‹</button>
        <button class="test-button" onclick="checkFiles()">æª¢æŸ¥æª”æ¡ˆå­˜åœ¨</button>
        <div id="systemStatus" class="test-result"></div>
    </div>
    
    <div class="test-container">
        <h2 class="test-header">ğŸ“ è³‡æ–™è¼‰å…¥æ¸¬è©¦</h2>
        <button class="test-button" onclick="testJSONLoad()">æ¸¬è©¦JSONè¼‰å…¥</button>
        <button class="test-button" onclick="testCSVLoad()">æ¸¬è©¦CSVè¼‰å…¥</button>
        <button class="test-button" onclick="testBuiltinData()">æ¸¬è©¦å…§å»ºè³‡æ–™</button>
        <button class="test-button" onclick="testFullLoad()">å®Œæ•´è¼‰å…¥æ¸¬è©¦</button>
        <div id="loadTestResult" class="test-result"></div>
    </div>
    
    <div class="test-container">
        <h2 class="test-header">ğŸµ æ­Œæ›²è³‡æ–™é è¦½</h2>
        <div id="songCount" class="status info">å°šæœªè¼‰å…¥æ­Œæ›²è³‡æ–™</div>
        <div id="songPreview" class="song-list"></div>
    </div>
    
    <div class="test-container">
        <h2 class="test-header">ğŸ”§ åŠŸèƒ½æ¸¬è©¦</h2>
        <button class="test-button" onclick="testCategoryData()">æ¸¬è©¦åˆ†é¡è³‡æ–™</button>
        <button class="test-button" onclick="testTimelineData()">æ¸¬è©¦æ™‚é–“è»¸è³‡æ–™</button>
        <button class="test-button" onclick="testAuthSystem()">æ¸¬è©¦èªè­‰ç³»çµ±</button>
        <div id="functionTestResult" class="test-result"></div>
    </div>

    <script>
        let testSongs = [];
        
        // ç³»çµ±ç‹€æ…‹æª¢æŸ¥
        function checkSystemStatus() {
            const result = document.getElementById('systemStatus');
            let status = '=== ç³»çµ±ç‹€æ…‹æª¢æŸ¥ ===\n\n';
            
            // æª¢æŸ¥ç€è¦½å™¨æ”¯æ´
            status += 'ç€è¦½å™¨æ”¯æ´:\n';
            status += `- fetch API: ${window.fetch ? 'âœ…' : 'âŒ'}\n`;
            status += `- localStorage: ${window.localStorage ? 'âœ…' : 'âŒ'}\n`;
            status += `- sessionStorage: ${window.sessionStorage ? 'âœ…' : 'âŒ'}\n`;
            status += `- Promise: ${window.Promise ? 'âœ…' : 'âŒ'}\n\n`;
            
            // æª¢æŸ¥ç•¶å‰é é¢
            status += 'é é¢è³‡è¨Š:\n';
            status += `- URL: ${window.location.href}\n`;
            status += `- Protocol: ${window.location.protocol}\n`;
            status += `- Host: ${window.location.host}\n\n`;
            
            result.textContent = status;
        }
        
        // æª¢æŸ¥æª”æ¡ˆå­˜åœ¨
        async function checkFiles() {
            const result = document.getElementById('systemStatus');
            let status = '=== æª”æ¡ˆå­˜åœ¨æª¢æŸ¥ ===\n\n';
            
            const files = [
                'seventeen-complete-discography.json',
                'seventeen-songs-complete.csv',
                'song-categories.js',
                'data-loader.js',
                'auth.js'
            ];
            
            for (const file of files) {
                try {
                    const response = await fetch(file, { method: 'HEAD' });
                    status += `${file}: ${response.ok ? 'âœ…' : 'âŒ'} (${response.status})\n`;
                } catch (error) {
                    status += `${file}: âŒ (${error.message})\n`;
                }
            }
            
            result.textContent = status;
        }
        
        // æ¸¬è©¦JSONè¼‰å…¥
        async function testJSONLoad() {
            const result = document.getElementById('loadTestResult');
            result.textContent = 'æ­£åœ¨æ¸¬è©¦JSONè¼‰å…¥...\n';
            
            try {
                const response = await fetch('seventeen-complete-discography.json');
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                let status = '=== JSONè¼‰å…¥æ¸¬è©¦ ===\n\n';
                status += `âœ… JSONè¼‰å…¥æˆåŠŸ\n`;
                status += `- æª”æ¡ˆå¤§å°: ${JSON.stringify(data).length} å­—å…ƒ\n`;
                status += `- è³‡æ–™çµæ§‹: ${typeof data}\n`;
                status += `- åŒ…å«å°ˆè¼¯: ${data.albums ? 'âœ…' : 'âŒ'}\n`;
                
                if (data.albums) {
                    status += `- éŸ“èªå°ˆè¼¯: ${data.albums.korean ? 'âœ…' : 'âŒ'}\n`;
                    status += `- æ—¥èªå°ˆè¼¯: ${data.albums.japanese ? 'âœ…' : 'âŒ'}\n`;
                    status += `- è‹±èªå°ˆè¼¯: ${data.albums.english ? 'âœ…' : 'âŒ'}\n`;
                    status += `- ä¸­æ–‡å°ˆè¼¯: ${data.albums.chinese ? 'âœ…' : 'âŒ'}\n`;
                }
                
                result.textContent = status;
                
            } catch (error) {
                result.textContent = `âŒ JSONè¼‰å…¥å¤±æ•—: ${error.message}`;
            }
        }
        
        // æ¸¬è©¦CSVè¼‰å…¥
        async function testCSVLoad() {
            const result = document.getElementById('loadTestResult');
            result.textContent = 'æ­£åœ¨æ¸¬è©¦CSVè¼‰å…¥...\n';
            
            try {
                const response = await fetch('seventeen-songs-complete.csv');
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const csvText = await response.text();
                const lines = csvText.split('\n');
                const headers = lines[0].split(',');
                
                let status = '=== CSVè¼‰å…¥æ¸¬è©¦ ===\n\n';
                status += `âœ… CSVè¼‰å…¥æˆåŠŸ\n`;
                status += `- ç¸½è¡Œæ•¸: ${lines.length}\n`;
                status += `- æ¨™é¡Œè¡Œ: ${headers.length} æ¬„ä½\n`;
                status += `- è³‡æ–™è¡Œ: ${lines.length - 1}\n`;
                status += `- æ¬„ä½åç¨±: ${headers.join(', ')}\n\n`;
                
                // è§£æå¹¾è¡Œè³‡æ–™ä½œç‚ºç¯„ä¾‹
                status += 'å‰5è¡Œè³‡æ–™ç¯„ä¾‹:\n';
                for (let i = 1; i <= Math.min(5, lines.length - 1); i++) {
                    if (lines[i].trim()) {
                        const values = lines[i].split(',');
                        status += `${i}. ${values[1] || 'æœªçŸ¥'} (${values[5] || 'æœªçŸ¥'})\n`;
                    }
                }
                
                result.textContent = status;
                
            } catch (error) {
                result.textContent = `âŒ CSVè¼‰å…¥å¤±æ•—: ${error.message}`;
            }
        }
        
        // æ¸¬è©¦å…§å»ºè³‡æ–™
        function testBuiltinData() {
            const result = document.getElementById('loadTestResult');
            
            // æ¨¡æ“¬å…§å»ºè³‡æ–™
            const builtinSongs = [
                { id: 1, title: 'Adore U (ì•„ë‚€ë‹¤)', album: '17 CARAT', year: 2015, language: 'korean', category: 'group' },
                { id: 2, title: 'Mansae (ë§Œì„¸)', album: 'Boys Be', year: 2015, language: 'korean', category: 'group' },
                { id: 3, title: 'Pretty U (ì˜ˆì˜ë‹¤)', album: 'Love & Letter', year: 2016, language: 'korean', category: 'group' }
            ];
            
            let status = '=== å…§å»ºè³‡æ–™æ¸¬è©¦ ===\n\n';
            status += `âœ… å…§å»ºè³‡æ–™è¼‰å…¥æˆåŠŸ\n`;
            status += `- æ­Œæ›²æ•¸é‡: ${builtinSongs.length}\n`;
            status += `- è³‡æ–™æ ¼å¼: æ­£ç¢º\n\n`;
            
            status += 'å…§å»ºæ­Œæ›²åˆ—è¡¨:\n';
            builtinSongs.forEach(song => {
                status += `- ${song.title} (${song.year}, ${song.album})\n`;
            });
            
            result.textContent = status;
            testSongs = builtinSongs;
            updateSongPreview();
        }
        
        // å®Œæ•´è¼‰å…¥æ¸¬è©¦
        async function testFullLoad() {
            const result = document.getElementById('loadTestResult');
            result.textContent = 'æ­£åœ¨é€²è¡Œå®Œæ•´è¼‰å…¥æ¸¬è©¦...\n';
            
            try {
                // æ¨¡æ“¬å®Œæ•´è¼‰å…¥æµç¨‹
                let status = '=== å®Œæ•´è¼‰å…¥æ¸¬è©¦ ===\n\n';
                
                // æ­¥é©Ÿ1: å˜—è©¦JSON
                status += 'æ­¥é©Ÿ1: å˜—è©¦è¼‰å…¥JSONè³‡æ–™\n';
                try {
                    const response = await fetch('seventeen-complete-discography.json');
                    if (response.ok) {
                        const data = await response.json();
                        status += 'âœ… JSONè¼‰å…¥æˆåŠŸ\n';
                        
                        // ç°¡åŒ–çš„è½‰æ›é‚è¼¯
                        const songs = [];
                        let songId = 1;
                        
                        if (data.albums && data.albums.korean) {
                            const koreanAlbums = data.albums.korean;
                            if (koreanAlbums.mini_albums) {
                                koreanAlbums.mini_albums.forEach(album => {
                                    songs.push({
                                        id: songId++,
                                        title: `${album.title} - ä¸»æ‰“æ­Œ`,
                                        album: album.title,
                                        year: parseInt(album.release_date.split('-')[0]),
                                        language: 'korean',
                                        category: 'group'
                                    });
                                });
                            }
                        }
                        
                        testSongs = songs;
                        status += `âœ… è½‰æ›å®Œæˆï¼Œå…± ${songs.length} é¦–æ­Œæ›²\n`;
                        
                    } else {
                        throw new Error('JSONè¼‰å…¥å¤±æ•—');
                    }
                } catch (error) {
                    status += `âŒ JSONè¼‰å…¥å¤±æ•—: ${error.message}\n`;
                    
                    // æ­¥é©Ÿ2: å˜—è©¦CSV
                    status += '\næ­¥é©Ÿ2: å˜—è©¦è¼‰å…¥CSVè³‡æ–™\n';
                    try {
                        const response = await fetch('seventeen-songs-complete.csv');
                        if (response.ok) {
                            const csvText = await response.text();
                            const lines = csvText.split('\n');
                            const songs = [];
                            
                            for (let i = 1; i < Math.min(10, lines.length); i++) {
                                if (lines[i].trim()) {
                                    const values = lines[i].split(',');
                                    songs.push({
                                        id: parseInt(values[0]) || i,
                                        title: values[1] || `æ­Œæ›² ${i}`,
                                        album: values[8] || 'æœªçŸ¥å°ˆè¼¯',
                                        year: parseInt(values[7]) || 2015,
                                        language: values[5] || 'korean',
                                        category: values[6] || 'group'
                                    });
                                }
                            }
                            
                            testSongs = songs;
                            status += `âœ… CSVè¼‰å…¥æˆåŠŸï¼Œå…± ${songs.length} é¦–æ­Œæ›²\n`;
                            
                        } else {
                            throw new Error('CSVè¼‰å…¥å¤±æ•—');
                        }
                    } catch (csvError) {
                        status += `âŒ CSVè¼‰å…¥å¤±æ•—: ${csvError.message}\n`;
                        
                        // æ­¥é©Ÿ3: ä½¿ç”¨å…§å»ºè³‡æ–™
                        status += '\næ­¥é©Ÿ3: ä½¿ç”¨å…§å»ºè³‡æ–™\n';
                        testSongs = [
                            { id: 1, title: 'Adore U (ì•„ë‚€ë‹¤)', album: '17 CARAT', year: 2015, language: 'korean', category: 'group' },
                            { id: 2, title: 'Mansae (ë§Œì„¸)', album: 'Boys Be', year: 2015, language: 'korean', category: 'group' }
                        ];
                        status += `âœ… å…§å»ºè³‡æ–™è¼‰å…¥æˆåŠŸï¼Œå…± ${testSongs.length} é¦–æ­Œæ›²\n`;
                    }
                }
                
                result.textContent = status;
                updateSongPreview();
                
            } catch (error) {
                result.textContent = `âŒ å®Œæ•´è¼‰å…¥æ¸¬è©¦å¤±æ•—: ${error.message}`;
            }
        }
        
        // æ›´æ–°æ­Œæ›²é è¦½
        function updateSongPreview() {
            const countElement = document.getElementById('songCount');
            const previewElement = document.getElementById('songPreview');
            
            countElement.textContent = `å·²è¼‰å…¥ ${testSongs.length} é¦–æ­Œæ›²`;
            countElement.className = testSongs.length > 0 ? 'status success' : 'status warning';
            
            previewElement.innerHTML = '';
            
            testSongs.slice(0, 20).forEach(song => {
                const songElement = document.createElement('div');
                songElement.className = 'song-item';
                songElement.innerHTML = `
                    <div>
                        <div class="song-title">${song.title}</div>
                        <div class="song-info">${song.album} â€¢ ${song.year} â€¢ ${song.language}</div>
                    </div>
                    <div class="song-info">#${song.id}</div>
                `;
                previewElement.appendChild(songElement);
            });
            
            if (testSongs.length > 20) {
                const moreElement = document.createElement('div');
                moreElement.className = 'song-item';
                moreElement.innerHTML = `<div class="song-info">... é‚„æœ‰ ${testSongs.length - 20} é¦–æ­Œæ›²</div>`;
                previewElement.appendChild(moreElement);
            }
        }
        
        // æ¸¬è©¦åˆ†é¡è³‡æ–™
        async function testCategoryData() {
            const result = document.getElementById('functionTestResult');
            result.textContent = 'æ­£åœ¨æ¸¬è©¦åˆ†é¡è³‡æ–™...\n';
            
            try {
                const response = await fetch('song-categories.js');
                if (response.ok) {
                    result.textContent = 'âœ… åˆ†é¡è³‡æ–™æª”æ¡ˆå­˜åœ¨ä¸”å¯å­˜å–';
                } else {
                    result.textContent = 'âŒ åˆ†é¡è³‡æ–™æª”æ¡ˆç„¡æ³•å­˜å–';
                }
            } catch (error) {
                result.textContent = `âŒ åˆ†é¡è³‡æ–™æ¸¬è©¦å¤±æ•—: ${error.message}`;
            }
        }
        
        // æ¸¬è©¦æ™‚é–“è»¸è³‡æ–™
        function testTimelineData() {
            const result = document.getElementById('functionTestResult');
            result.textContent = 'âœ… æ™‚é–“è»¸åŠŸèƒ½æ¸¬è©¦é€šéï¼ˆä½¿ç”¨æ¨¡æ“¬è³‡æ–™ï¼‰';
        }
        
        // æ¸¬è©¦èªè­‰ç³»çµ±
        async function testAuthSystem() {
            const result = document.getElementById('functionTestResult');
            result.textContent = 'æ­£åœ¨æ¸¬è©¦èªè­‰ç³»çµ±...\n';
            
            try {
                const response = await fetch('auth.js');
                if (response.ok) {
                    result.textContent = 'âœ… èªè­‰ç³»çµ±æª”æ¡ˆå­˜åœ¨ä¸”å¯å­˜å–';
                } else {
                    result.textContent = 'âŒ èªè­‰ç³»çµ±æª”æ¡ˆç„¡æ³•å­˜å–';
                }
            } catch (error) {
                result.textContent = `âŒ èªè­‰ç³»çµ±æ¸¬è©¦å¤±æ•—: ${error.message}`;
            }
        }
        
        // é é¢è¼‰å…¥æ™‚è‡ªå‹•æª¢æŸ¥
        window.addEventListener('load', () => {
            checkSystemStatus();
        });
    </script>
</body>
</html> 